# GPIO

[【STM32】GPIO工作原理（八种工作方式超详细分析，附电路图）_Yngz_Miao的博客-CSDN博客_stm32gpio](https://blog.csdn.net/qq_38410730/article/details/79858906)

![img](https://img-blog.csdn.net/20180408224319518)

里面有三个比较重要的器件

+ 保护二极管：防止引脚外部过高、过低的电压输入。当然最好还要加隔离电路驱动
+ P-MOS管和N-MOS管：这两者使GPIO具有“推挽输出”和“开漏输出”
+ TTL肖特基触发器：信号经过触发器后，模拟信号转化为0，1的信号。

+ FT:兼容5V

## 输入模式

+ 浮空：

  ![img](https://img-blog.csdn.net/2018040822505125)

  I/O电平信号直接进入数据寄存器。但是在引脚悬空情况下，该端口电平是不确定的。

+ 上拉

  ![img](https://i.loli.net/2021/06/24/5pegQX41KkwcEsi.png)

  I/O电平信号直接进入数据寄存器。但是在引脚悬空情况下，管脚保持在高电平。当I/O端口为低电平时，输入端电平仍然为低电平

+ 下拉

  ![img](https://img-blog.csdn.net/20180408225847140)

  I/O电平信号直接进入数据寄存器。但是在引脚悬空情况下，管脚保持在低电平。当I/O端口为高电平时，输入端电平仍然为高电平

+ 模拟

  ![img](https://img-blog.csdn.net/20180409125151818)

  在模拟输入下，I/O端口的模拟信号此时输入的为原始电压信号而非电平信号，一般用在ADC采样中。

## 输出模式

+ 开漏输出

  ![img](https://img-blog.csdn.net/2018040912560259)

+ 开漏复用输出

+ 推挽输出

  ![img](https://img-blog.csdn.net/20180409131225598)

+ 推挽复用输出

## 总结

+ 开漏输出和推挽的区别
  + 开漏：只可以输出强低电平。高电平得靠外部电阻拉高，适用于做电流型的驱动。
  + 推挽：可以输出强高、低电平，连接数字器件。

+ 在STM32中选用怎样选择I/O模式？

+ 浮空输入_IN_FLOATING ——浮空输入，可以做KEY识别，RX1
+ 带上拉输入_IPU——IO内部上拉电阻输入
+ 带下拉输入_IPD—— IO内部下拉电阻输入
+ 模拟输入_AIN ——应用ADC模拟输入，或者低功耗下省电
+ 开漏输出_OUT_OD ——IO输出0接GND，IO输出1，悬空，需要外接上拉电阻，才能实现输出高电平。当输出为1时，IO口的状态由上拉电阻拉高电平，但由于是开漏输出模式，这样IO口也就可以由外部电路改变为低电平或不变。可以读IO输入电平变化，实现C51的IO双向功能
+ 推挽输出_OUT_PP ——IO输出0-接GND， IO输出1 -接VCC，读输入值是未知的
+ 复用功能的推挽输出_AF_PP ——片内外设功能（I2C的SCL、SDA）
+ 复用功能的开漏输出_AF_OD——片内外设功能（TX1、MOSI、MISO.SCK.SS）